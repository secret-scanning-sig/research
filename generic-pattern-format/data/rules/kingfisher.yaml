rules:
  - name: AWS Acess Key ID
    id: S3IGDPG4G2UGSQPG4SCE
    pattern: (?:\A|\W)((?:A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA|ABIA|ACCA)[A-Z2-7]{16})(?:\W|\z)
    min_entropy: 3.0
    confidence: medium
    examples:
      - AKIAABCDEFGHIJKLMNOP
      - AKIADEADBEEFDEADBEEF
    references:
      - https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html#identifiers-unique-ids
      - https://medium.com/@TalBeerySec/a-short-note-on-aws-key-id-f88cc4317489
    visibile: true
  - name: AWS Secret Access Key
    id: S3IGDPG4G2UGSQPG4SCF
    pattern: (?:\A|(?i)(?:aws|access).{0,16}(?:key|secret).+\W)([\w\_\/]+)(?:\W|\z)
    min_entropy: 3.0
    confidence: medium
    references:
      - https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html#identifiers-unique-ids
    visibile: true
    depends_on_rule:
      - rule_id: S3IGDPG4G2UGSQPG4SCE
        variable: aws_secret_access_key
  - name: Atlassian API token
    id: S3IGTVE2THEZF64SBFFM
    pattern: (?:(?i)[\w.-]{0,50}?(?:(?-i:ATLASSIAN|[Aa]tlassian)|(?-i:CONFLUENCE|[Cc]onfluence)|(?-i:JIRA|[Jj]ira))(?:[ \t\w.-]{0,20})[\s'\"]{0,3}(?:=|>|:{1,3}=|\|\||:|=>|\?=|,)[\x60'"\s=]{0,5})([a-z0-9]{20}[a-f0-9]{4})(?:\W|\z)
    min_entropy: 3.5
    references:
      - https://github.com/gitleaks/gitleaks/blob/master/config/gitleaks.toml
      - https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account/
    visibile: true
  - name: Atlassian API token
    id: S3IG7NHZTOAWKKLZIHAJ
    pattern: (?:\A|\W)(ATATT3[A-Za-z0-9_\-=]{186})(?:\W|\z)
    min_entropy: 3.5
    references:
      - https://github.com/gitleaks/gitleaks/blob/master/config/gitleaks.toml
      - https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account/
    visibile: true
  - name: Cloudflare Origin CA Key
    id: S3IGTVE2THEZF64SBFFM
    pattern: (?:\A|\W)(v1\.0-[a-f0-9]{24}-[a-f0-9]{146})(?:[\x60\'\"\s;]|\\[nr]|$)
    min_entropy: 2.0
    visibile: true
  - name: Basic Auth Password
    id: S3IGHP6SVITIDKEB5QEE
    pattern: (?:(?:\A|\W)curl\s[\s\S]{0,128}(?:--user|-u)[\s=]+[^:]{0,128}:[\\'\"]?)([^'"\s\`]{3,128})
    min_entropy: 2.0
    visibile: true
  - name: WireGuard Private Key
    id: S3IGPYKJZOEVVGDMWCWD
    pattern: (?:PrivateKey\s*=\s*)([A-Za-z0-9+/]{43}=)
    references:
      - https://www.wireguard.com/quickstart/
      - https://manpages.debian.org/testing/wireguard-tools/wg.8.en.html
      - https://gist.github.com/lanceliao/5d2977f417f34dda0e3d63ac7e217fd6
    visibile: true
  - name: WireGuard Preshared Key
    id: S3IGXMTJQ5OTBD37ES7Q
    pattern: (?:PresharedKey\s*=\s*)([A-Za-z0-9+/]{43}=)
    examples:
      - |
        [Peer]
        PublicKey = [Server's public key]
        PresharedKey = uRsfsZ2Ts1rach4Zv3hhwcx6wa5fuIo2u3w7sa+7j81=
        AllowedIPs = 0.0.0.0/0, ::/0
        Endpoint = [Server Addr:Server Port]
    references:
      - https://www.wireguard.com/quickstart/
      - https://manpages.debian.org/testing/wireguard-tools/wg.8.en.html
      - https://gist.github.com/lanceliao/5d2977f417f34dda0e3d63ac7e217fd6
    visibile: true
  - name: AWS S3 Bucket
    id: S3IGPHWSTKPXP2TMEKHU
    pattern: (?:(?:\A|[\s\/\"']|%2F))([\w-]+)(?:(?i)\.s3(?:-(?:af|ap|ca|eu|me|sa|us(?:-gov)?)-(?:central|(?:north|south)(?:east|west)?)-[1-3])?\.amazonaws\.com(?:\W|\z))
    examples:
      - example-bucket.s3.amazonaws.com
      - http://bucket.s3-us-east-2.amazonaws.com
      - http%2F%2Fsome-bucket.s3.amazonaws.com
    references:
      - https://docs.aws.amazon.com/general/latest/gr/rande.html
    visibile: true
  - name: GitHub Personal Access Token
    id: S3IGTAZC4EEQJF2U67DZ
    pattern: (?:\A|\W)(ghp_[0-9A-Za-z]{36})(?:\W|\z)
    visibile: true
    validation:
      type: Http
      content:
        request:
          method: POST
          url: https://api.github.com/user
          headers:
            Accept: application/vnd.github.v3+json
            Authorization: Bearer {{ TOKEN }}
          response_matcher:
            - type: JsonValid
            - type: StatusMatch
              status:
                - 200
              negative: false
            - type: HeaderMatch
              header: Server
              expected:
                - github.com
            - type: HeaderMatch
              header: X-Github-Api-Version-Selected
              expected:
                - '2022-11-28'

